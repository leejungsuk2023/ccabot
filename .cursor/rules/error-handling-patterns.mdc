# ì˜¤ë¥˜ ì²˜ë¦¬ ë° ë¬¸ì œ í•´ê²° ê°€ì´ë“œ

## ğŸ”¥ ì£¼ìš” ì˜¤ë¥˜ íŒ¨í„´ ë° í•´ê²°ì±…

### 1. Firebase Functions v2 ë¬¸ë²• ì˜¤ë¥˜
**ì˜¤ë¥˜**: `POST 500 Internal Server Error`
**ì›ì¸**: êµ¬ë²„ì „ ë¬¸ë²• ì‚¬ìš©
```javascript
// âŒ ì˜ëª»ëœ ë¬¸ë²•
const {onRequest} = require("firebase-functions/v2/https");
exports.functionName = onRequest({...}, async (req, res) => {

// âœ… ì˜¬ë°”ë¥¸ ë¬¸ë²•
const { https } = require("firebase-functions/v2");
exports.functionName = https.onRequest({region: "asia-northeast3"}, async (req, res) => {
```

### 2. Firebase Admin SDK ì¸ì¦ ì˜¤ë¥˜
**ì˜¤ë¥˜**: `Could not load the default credentials`
**ì›ì¸**: ë¡œì»¬ í™˜ê²½ì—ì„œ ì¸ì¦ ì •ë³´ ë¶€ì¡±
**í•´ê²°ì±…**:
```javascript
// í´ë¼ìš°ë“œ í™˜ê²½ì—ì„œëŠ” ìë™ ì¸ì¦
if (!admin.apps.length) {
  admin.initializeApp();
}

// ë¡œì»¬ í…ŒìŠ¤íŠ¸ ì‹œì—ëŠ” í”„ë¡œì íŠ¸ ID ëª…ì‹œ
if (!admin.apps.length) {
  admin.initializeApp({
    projectId: 'your-project-id'
  });
}
```

### 3. Project ID ê°ì§€ ì˜¤ë¥˜
**ì˜¤ë¥˜**: `Unable to detect a Project Id in the current environment`
**í•´ê²°ì±…**: 
- [.firebaserc](mdc:.firebaserc) íŒŒì¼ì—ì„œ í”„ë¡œì íŠ¸ ID í™•ì¸
- í™˜ê²½ ë³€ìˆ˜ `GOOGLE_CLOUD_PROJECT` ì„¤ì •
- Firebase CLI ë¡œê·¸ì¸ í™•ì¸: `firebase login`

### 4. íŒŒì¼ ê²½ë¡œ ì˜¤ë¥˜
**ì˜¤ë¥˜**: `ENOENT: no such file or directory`
**í•´ê²°ì±…**:
```javascript
// âœ… ì ˆëŒ€ ê²½ë¡œ ì‚¬ìš©
const path = require('path');
const filePath = path.join(__dirname, 'filename.csv');

// âŒ ìƒëŒ€ ê²½ë¡œ ì‚¬ìš© (ì˜¤ë¥˜ ë°œìƒ ê°€ëŠ¥)
const filePath = './filename.csv';
```

### 5. Git Bashì—ì„œ .bat íŒŒì¼ ì‹¤í–‰ ì˜¤ë¥˜
**ì˜¤ë¥˜**: `bash: run_update_ai_brain.bat: command not found`
**í•´ê²°ì±…**:
```bash
# ë°©ë²• 1: cmd ì‚¬ìš©
cmd /c "cd functions && run_update_ai_brain.bat"

# ë°©ë²• 2: .sh íŒŒì¼ ìƒì„±
bash run_update_ai_brain.sh

# ë°©ë²• 3: ì§ì ‘ ëª…ë ¹ì–´ ì‹¤í–‰
npm install && node update_ai_brain.js
```

## ğŸ”§ ë””ë²„ê¹… ì „ëµ

### 1. ë‹¨ê³„ë³„ í…ŒìŠ¤íŠ¸
```javascript
// 1. íŒŒì¼ ì¡´ì¬ í™•ì¸
console.log('CSV íŒŒì¼ ê²½ë¡œ:', filePath);
console.log('íŒŒì¼ ì¡´ì¬:', fs.existsSync(filePath));

// 2. CSV ì½ê¸° í…ŒìŠ¤íŠ¸
const data = await readCSVFile(filePath);
console.log('ì½ì€ ë°ì´í„°:', data);

// 3. Firestore ì—°ê²° í…ŒìŠ¤íŠ¸
const testDoc = await db.collection('test').doc('test').get();
console.log('Firestore ì—°ê²° ì„±ê³µ');
```

### 2. í™˜ê²½ ë³€ìˆ˜ í™•ì¸
```javascript
// í™˜ê²½ ì •ë³´ ë¡œê¹…
console.log('NODE_ENV:', process.env.NODE_ENV);
console.log('FUNCTIONS_EMULATOR:', process.env.FUNCTIONS_EMULATOR);
console.log('GOOGLE_CLOUD_PROJECT:', process.env.GOOGLE_CLOUD_PROJECT);
```

### 3. ì˜ì¡´ì„± í™•ì¸
```bash
# package.json ì˜ì¡´ì„± í™•ì¸
npm list csv-parser firebase-admin firebase-functions

# ëˆ„ë½ëœ ì˜ì¡´ì„± ì„¤ì¹˜
npm install csv-parser
```

## ğŸš€ ë°°í¬ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸

### 1. ì½”ë“œ ê²€ì¦
- [ ] Firebase Functions v2 ë¬¸ë²• ì‚¬ìš©
- [ ] íŒŒì¼ ê²½ë¡œê°€ `__dirname` ê¸°ë°˜
- [ ] ì—ëŸ¬ í•¸ë“¤ë§ í¬í•¨
- [ ] ë¡œê¹… ì¶”ê°€

### 2. ì˜ì¡´ì„± í™•ì¸
- [ ] [functions/package.json](mdc:functions/package.json)ì— í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ í¬í•¨
- [ ] `npm install` ì‹¤í–‰ ì™„ë£Œ
- [ ] `package-lock.json` ìµœì‹  ìƒíƒœ

### 3. íŒŒì¼ êµ¬ì¡° í™•ì¸
- [ ] CSV íŒŒì¼ë“¤ì´ [functions/](mdc:functions/) í´ë”ì— ìœ„ì¹˜
- [ ] [firebase.json](mdc:firebase.json) ì„¤ì • ì˜¬ë°”ë¦„
- [ ] [.firebaserc](mdc:.firebaserc) í”„ë¡œì íŠ¸ ID ì˜¬ë°”ë¦„

### 4. ë°°í¬ í›„ ê²€ì¦
```bash
# í•¨ìˆ˜ URL í™•ì¸
firebase functions:list

# í•¨ìˆ˜ í…ŒìŠ¤íŠ¸
curl "https://asia-northeast3-project-id.cloudfunctions.net/functionName"

# ë¡œê·¸ í™•ì¸
firebase functions:log --only functionName
```

## ğŸ“Š ì„±ê³µì ì¸ ì‹¤í–‰ í™•ì¸

### ì •ìƒ ì‘ë‹µ ì˜ˆì‹œ
```json
{
  "success": true,
  "message": "AI ë‘ë‡Œ ì—…ë°ì´íŠ¸ê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!"
}
```

### ì˜¤ë¥˜ ì‘ë‹µ ì˜ˆì‹œ
```json
{
  "success": false,
  "error": "CSV íŒŒì¼ì„ ì½ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ENOENT: no such file or directory"
}
```
description:
globs:
alwaysApply: false
---
